import org.openhab.core.library.types.*
//import org.openhab.core.library.items.*
import org.openhab.core.persistence.*
import org.openhab.model.script.actions.*

import org.joda.time.*

import java.util.HashSet
import java.util.Iterator
import java.util.Set

var Set requests = new HashSet()
//var Iterator iter = requests.iterator()

rule "Process master"
when
	Item RelayduinoRelay1State received command or
	Item RelayduinoRelay2State received command or
	Item RelayduinoRelay3State received command or
	Item RelayduinoRelay4State received command
then
	if (receivedCommand == ON) {
		RelayduinoRelay8Request.sendCommand(ON)
	} else {
		RelayduinoRelay8Request.sendCommand(OFF)
	}
end

rule  "Update requests"
when
	Item RelayduinoRelay1Request received command
then
	if (receivedCommand == ON) {
		requests.add(1)
	} else {
		requests.remove(1)
	}
	postUpdate(RelayduinoRequests, requests.size())
end
